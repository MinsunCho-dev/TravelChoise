<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>로그인 | 여행어때</title>
  <link rel="shortcut icon" href="../static/img/favicon.ico">
  <link rel="stylesheet" type="text/css" href="../static/css/common.css">
  <link rel="stylesheet" type="text/css" href="../static/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
   $(window).on('load', function() {
       var cookieArr = document.cookie.split("; ");

       if (cookieArr.includes('id=remember')) {
           var id_input = document.getElementById('user');
           var id = document.getElementById('id').innerText;
           id_input.value = id;

           $("#userid_Remember").prop('checked', true);
       }
   })
</script>
</head>
</head>

<body>
  <div class="snowflakes" aria-hidden="true">
    <div class="snowflake">❅</div>
    <div class="snowflake">❅</div>
    <div class="snowflake">❆</div>
    <div class="snowflake">❄</div>
    <div class="snowflake">❅</div>
    <div class="snowflake">❆</div>
    <div class="snowflake">❄</div>
    <div class="snowflake">❆</div>
    <div class="snowflake">❆</div>
    <div class="snowflake">❄</div>
  </div>

  <div class="login-div">
    <a href="http://localhost:8000/" class="login-logo" title="여행어때">여행어때</a>
    <form id="login-form">
      <br>
      <input class="login-input" type="text" name="id" placeholder="아이디" required>
      <br>
      <br>
      <input class="login-input" type="password" name="pw" placeholder="비밀번호" required>
      <br>
      <br>
      <div class="remember"><label for="userid_Remember" style="font-size: 0.7rem;"><input type="checkbox" id="userid_Remember" name="id_remember" onclick="idRemember()">&nbsp;아이디 기억하기</label></div>
      <button class="login-btn" type="button" onclick="login();">로그인</button>
      <br>
      <br>
      <span id="exa" style="color: red;"></span>
      <br>
      <br>
      <span>아직 회원이 아니신가요?</span>&nbsp;
      <a href="http://localhost:8000/signup" style="text-decoration-line : none; color: blue;">회원가입</a>
      <span>하러가기</span>
    </form>
    <br>
    <a href="/user/login/kakao"><img src="/static/img/kakao_login_medium_wide.png" id="login-kakao" alt="카카오 로그인"></a>
    <!-- <br>
    <br>
    <a href="javascript:void(0);" onclick="findPw();return false;">비밀번호 찾기</a> -->
  </div>

  <script>a
    function login() {
      let form = document.getElementById("login-form");
      axios({
        method: 'post',
        url: '/user/login',
        data: {
          id: form.id.value,
          pw: form.pw.value
        }
      }).then((res) => {
        if (res.data) {
          document.location.href = '/';
        } else {
          var exa = document.getElementById('exa');
          exa.innerText ="아이디 또는 비밀번호를 다시 확인해주세요.";
          form.reset();
        }
      })
    }
    function register() {
      document.location.href="http://localhost:8000/signup";
    }

    function findPw() {
      document.location.href="http://localhost:8000/user/find";
    }
                 
   function idRemember() {
      var cookieArr = document.cookie.split("; ");
      if (cookieArr.includes('id=remember')) {  
        // 쿠키 삭제
        var date = new Date();
        date.setDate(date.getDate() - 10); 
        var before = date.toGMTString();
        document.cookie = `id=remember; expires=${before}}`;
      } else { 
          var date = new Date();
          date.setDate(date.getDate() + 30); 
          var afterMonth = date.toGMTString();
                    
           // 아이디를 기억해줘 누르면 쿠키 생성해주기
           document.cookie = `id=remember; expires=${afterMonth}`;
         }
          }
  </script>

</body>

</html>